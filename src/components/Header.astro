---
import { type Language, type TranslationObject } from '../utils/i18n';

interface Props {
  lang: Language;
  t: TranslationObject;
}

const { lang, t } = Astro.props;
---

<header class="header">
  <div class="container header-content">
    <a href={lang === 'ar' ? '/' : '/en/'} class="logo">
      <img src="/logo.svg" alt="Business Partner Services" />
      <span>{lang === 'ar' ? 'شريك الأعمال' : 'Business Partner'}</span>
    </a>
    
    <nav class="nav">
      <a href={`${lang === 'ar' ? '' : '/en'}/#home`}>{t.nav.home}</a>
      <a href={`${lang === 'ar' ? '' : '/en'}/#services`}>{t.nav.services}</a>
      <a href={`${lang === 'ar' ? '' : '/en'}/#packages`}>{t.nav.packages}</a>
      <a href={`${lang === 'ar' ? '' : '/en'}/#setup`}>{t.nav.setup}</a>
      <a href={`${lang === 'ar' ? '' : '/en'}/#contact`}>{t.nav.contact}</a>
      
      <a href={lang === 'ar' ? '/en/' : '/'} class="lang-toggle" id="lang-toggle">
        {t.nav.language}
      </a>
    </nav>
  </div>
</header>

<script>
  const langToggle = document.getElementById('lang-toggle');
  if (langToggle) {
    langToggle.addEventListener('click', (e) => {
      e.preventDefault();
      const currentLang = document.documentElement.lang;
      const newUrl = currentLang === 'ar' ? '/en/' : '/';
      
      // Store preference
      localStorage.setItem('preferred-language', currentLang === 'ar' ? 'en' : 'ar');
      
      // Navigate
      window.location.href = newUrl;
    });
  }

  // Apply stored language preference on load
  document.addEventListener('DOMContentLoaded', () => {
    const storedLang = localStorage.getItem('preferred-language');
    const currentLang = document.documentElement.lang;
    
    if (storedLang && storedLang !== currentLang) {
      const newUrl = storedLang === 'ar' ? '/' : '/en/';
      window.location.href = newUrl;
    }
  });
</script>